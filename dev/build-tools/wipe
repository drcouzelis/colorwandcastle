#!/usr/bin/bash

[ "${EUID}" -eq 0 ] && echo "ERROR: Do not run as root." && exit 1

source "$(dirname ${0})"/settings

# Wipe

# Check if the working area doesn't even exist
if [ -d "${BUILD_workarea_path}" ]; then

    # Let GNU Autotools do the cleaning
    if [ -f "${BUILD_workarea_path}"/build/Makefile ]; then
        make -C "${BUILD_workarea_path}"/build uninstall
        make -C "${BUILD_workarea_path}"/build distclean
    fi
    
    # Delete any remaining empty directories
    find "${BUILD_workarea_path}" -type d -empty -delete

fi

# Delete GNU Autotools poop
rm -vrf "${BUILD_project_path}"/autom4te.cache
rm -vf "${BUILD_project_path}"/Makefile.in
rm -vf "${BUILD_project_path}"/aclocal.m4
rm -vf "${BUILD_project_path}"/compile
rm -vf "${BUILD_project_path}"/config.h
rm -vf "${BUILD_project_path}"/config.h.in
rm -vf "${BUILD_project_path}"/config.h.in~
rm -vf "${BUILD_project_path}"/configure
rm -vf "${BUILD_project_path}"/depcomp
rm -vf "${BUILD_project_path}"/install-sh
rm -vf "${BUILD_project_path}"/missing
